---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'---
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'- name: PAM and login hardening
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'  hosts: all
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'  become: true
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'  tasks:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'    - name: Install PAM password strength tools and libpam-tmpdir
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      apt:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        name:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          - libpam-pwquality
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          - libpam-tmpdir
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          - apt-listbugs
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          - apt-listchanges
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          - debsums
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          - apt-show-versions
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        state: present
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        update_cache: true
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'    - name: Configure pwquality (password strength)
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      copy:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        dest: /etc/security/pwquality.conf
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        owner: root
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        group: root
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        mode: '0644'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        content: |
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Longueur minimale
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          minlen = 12
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Au moins 1 majuscule
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          ucredit = -1
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Au moins 1 minuscule
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          lcredit = -1
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Au moins 1 chiffre
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          dcredit = -1
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Au moins 1 caractère spécial
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          ocredit = -1
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Nombre de caractères différents du mot de passe précédent
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          difok = 5
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          # Rejeter les mots du dictionnaire
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'          dictcheck = 1
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'    - name: Harden /etc/login.defs
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      lineinfile:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        path: /etc/login.defs
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        regexp: "{{ item.regexp }}"
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        line: "{{ item.line }}"
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        state: present
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        backup: true
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      loop:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - { regexp: '^UMASK',          line: 'UMASK           027' }
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'    - name: Set umask in /etc/profile
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      lineinfile:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        path: /etc/profile
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        regexp: '^umask'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        line: 'umask 027'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        state: present
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'    - name: Set umask in /etc/bash.bashrc
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      lineinfile:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        path: /etc/bash.bashrc
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        regexp: '^umask'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        line: 'umask 027'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        state: present
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'    - name: Disable core dumps in /etc/security/limits.conf
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      lineinfile:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        path: /etc/security/limits.conf
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        line: "{{ item }}"
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        state: present
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'      loop:
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - '* soft core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'        - '* hard core 0'
---
- name: PAM and login hardening
  hosts: all
  become: true

  tasks:
    - name: Install PAM password strength tools and libpam-tmpdir
      apt:
        name:
          - libpam-pwquality
          - libpam-tmpdir
          - debsums
          - apt-show-versions
        state: present
        update_cache: true

    - name: Configure pwquality (password strength)
      copy:
        dest: /etc/security/pwquality.conf
        owner: root
        group: root
        mode: '0644'
        content: |
          # Longueur minimale
          minlen = 12
          # Au moins 1 majuscule
          ucredit = -1
          # Au moins 1 minuscule
          lcredit = -1
          # Au moins 1 chiffre
          dcredit = -1
          # Au moins 1 caractère spécial
          ocredit = -1
          # Nombre de caractères différents du mot de passe précédent
          difok = 5
          # Rejeter les mots du dictionnaire
          dictcheck = 1

    - name: Harden /etc/login.defs
      lineinfile:
        path: /etc/login.defs
        regexp: "{{ item.regexp }}"
        line: "{{ item.line }}"
        state: present
        backup: true
      loop:
        - { regexp: '^PASS_MAX_DAYS',  line: 'PASS_MAX_DAYS   90' }
        - { regexp: '^PASS_MIN_DAYS',  line: 'PASS_MIN_DAYS   7' }
        - { regexp: '^PASS_WARN_AGE',  line: 'PASS_WARN_AGE   14' }
        - { regexp: '^UMASK',          line: 'UMASK           027' }
        - { regexp: '^SHA_CRYPT_MIN_ROUNDS', line: 'SHA_CRYPT_MIN_ROUNDS 65536' }
        - { regexp: '^SHA_CRYPT_MAX_ROUNDS', line: 'SHA_CRYPT_MAX_ROUNDS 65536' }

    - name: Set umask in /etc/profile
      lineinfile:
        path: /etc/profile
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Set umask in /etc/bash.bashrc
      lineinfile:
        path: /etc/bash.bashrc
        regexp: '^umask'
        line: 'umask 027'
        state: present

    - name: Disable core dumps in /etc/security/limits.conf
      lineinfile:
        path: /etc/security/limits.conf
        line: "{{ item }}"
        state: present
      loop:
        - '* soft core 0'
        - '* hard core 0'